{% extends 'empleados/base.html' %}
{% block content %}
<div class="page-body"><div class="container-fluid"><div class="page-title"><div class="row"><div class="col-6"><h4>{{ establecimiento.nombre }}</h4></div><div class="col-6"><ol class="breadcrumb"><li class="breadcrumb-item">AulaPro</li><li class="breadcrumb-item"><a href="{% url 'empleados:establecimientos_list' %}">Establecimientos</a></li><li class="breadcrumb-item active">{{ establecimiento.nombre }}</li></ol></div></div></div></div>
<div class="container-fluid">
  <div class="card"><div class="card-header card-no-border pb-0 d-flex justify-content-between"><h5>Detalle del establecimiento</h5><div class="d-flex gap-2"><a class="btn btn-outline-primary btn-sm" href="{% url 'empleados:editar_establecimiento' establecimiento.id %}">Editar</a><a class="btn btn-outline-info btn-sm" href="{% url 'empleados:editor_gafete' establecimiento.id %}">Diseño de Gafete</a><a class="btn btn-primary btn-sm" href="{% url 'empleados:crear_carrera' %}">Nueva Carrera</a></div></div><div class="card-body"><p class="mb-1"><strong>Dirección:</strong> {{ establecimiento.direccion|default:'-' }}</p>{% if ciclo_activo %}<p class="mb-0"><strong>Ciclo activo:</strong> <span class="badge badge-light-success">{{ ciclo_activo.nombre }}</span></p>{% else %}<p class="mb-0"><strong>Ciclo activo:</strong> <span class="badge badge-light-danger">Sin ciclo activo</span></p>{% endif %}</div></div>

  <div class="card"><div class="card-header card-no-border pb-0 d-flex justify-content-between align-items-center"><h5>Ciclos escolares</h5><div class="d-flex gap-2"><a class="btn btn-primary btn-sm" href="{% url 'empleados:ciclo_create' establecimiento.id %}"><i class="fa fa-plus"></i> Nuevo ciclo</a><a class="btn btn-outline-primary btn-sm" href="{% url 'empleados:ciclos_list' establecimiento.id %}">Ver todos</a></div></div><div class="card-body table-responsive"><table class="table table-striped"><thead><tr><th>Nombre</th><th>Año</th><th>Fechas</th><th>Estado</th><th>Activo</th><th>Acciones</th></tr></thead><tbody>{% for c in ciclos %}<tr><td>{{ c.nombre }}</td><td>{{ c.anio|default:'-' }}</td><td>{% if c.fecha_inicio or c.fecha_fin %}{{ c.fecha_inicio|default:'-' }} al {{ c.fecha_fin|default:'-' }}{% else %}-{% endif %}</td><td>{% if c.estado == 'activo' %}<span class="badge badge-light-success">Activo</span>{% else %}<span class="badge badge-light-warning">Inactivo</span>{% endif %}</td><td>{% if c.es_activo %}<span class="badge badge-light-success">Sí</span>{% else %}<span class="badge badge-light-secondary">No</span>{% endif %}</td><td>{% if not c.es_activo %}<form method="post" action="{% url 'empleados:ciclo_activar' establecimiento.id c.id %}">{% csrf_token %}<input type="hidden" name="next" value="{{ request.get_full_path }}"><button class="btn btn-outline-primary btn-sm" type="submit">Activar</button></form>{% else %}<span class="text-success small">Ciclo activo</span>{% endif %}</td></tr>{% empty %}<tr><td colspan="6">Sin ciclos escolares.</td></tr>{% endfor %}</tbody></table></div></div>

  <div class="card"><div class="card-header card-no-border pb-0"><h5>Carreras</h5></div><div class="card-body table-responsive"><table class="table table-striped"><thead><tr><th>Nombre</th><th>Estado</th><th>Acciones</th></tr></thead><tbody>{% for c in carreras %}<tr><td>{{ c.nombre }}</td><td>{% if c.activo %}<span class="badge badge-light-success">Activa</span>{% else %}<span class="badge badge-light-danger">Inactiva</span>{% endif %}</td><td><a class="btn btn-primary btn-sm" href="{% url 'empleados:carrera_detail' establecimiento.id c.id %}">Entrar</a></td></tr>{% empty %}<tr><td colspan="3">Sin carreras.</td></tr>{% endfor %}</tbody></table></div></div>
</div></div>
{% endblock %}
